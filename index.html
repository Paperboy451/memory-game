<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lieblingsgetr√§nke Memory</title>
<style>
  body {
    font-family: 'Comic Sans MS', cursive, sans-serif;
    background: #ffd27f; /* feste Farbe */
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0;
    padding: 0;
  }
  header {
    text-align: center;
    padding: 10px;
    color: #333;
  }
  .scoreboard {
    display: flex;
    justify-content: center;
    gap: 20px;
    font-size: 1.2rem;
    margin-bottom: 10px;
  }
  .player {
    padding: 4px 10px;
    border-radius: 8px;
    transition: all 0.3s;
  }
  .active {
    background: #ff6f61;
    color: #fff;
    transform: scale(1.1);
  }
  .game-board {
    display: grid;
    justify-content: center;
    gap: 15px;
    max-width: 95vw;
  }

  .card {
    perspective: 1000px;
    aspect-ratio: 1 / 1;
    position: relative;
  }
  .card-inner {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0; 
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform 0.6s;
    border-radius: 12px;
    box-sizing: border-box; 
  }
  .card.flipped .card-inner {
    transform: rotateY(180deg);
  }
  .card-front, .card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0; 
    box-sizing: border-box;
    backface-visibility: hidden;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 1.5rem;
    border: 3px solid #333;
  }
  .card-front {
    background: #fff3c4;
    color: #333;
    overflow: hidden;
  }
  .card-front img {
    display: block;
    width: 100%; 
    height: 100%;
    object-fit: cover;
    border-radius: 8px;
    border: none; 
  }
  .card-back {
    background: #ff6f61;
    transform: rotateY(180deg);
    overflow: hidden;
  }
  .card-back img {
    display: block;
    width: 100%;  
    height: 100%; 
    object-fit: cover; 
    border-radius: 8px;
    border: none;
  }
  @keyframes matchPulse {
  0%   { transform: rotateY(180deg) scale(1); box-shadow: 0 0 0px 0 rgba(0,255,128,0); }
  40%  { transform: rotateY(180deg) scale(1.15); box-shadow: 0 0 25px 10px rgba(0,255,128,0.8); }
  100% { transform: rotateY(180deg) scale(1); box-shadow: 0 0 0px 0 rgba(0,255,128,0); }
}

.card.matched .card-inner {
  animation: matchPulse 0.7s ease;
}
</style>
</head>
<body>

<header>
  <h1>Unser ‚ù§Ô∏è Memory</h1>
  <div class="scoreboard">
    <div id="player1" class="player"><span id="score1">0</span></div>
    <div id="player2" class="player"><span id="score2">0</span></div>
  </div>
</header>

<div id="gameBoard" class="game-board"></div>

<script>
  // === Einstellungen ===
  const flipDelay = 3000; // Zeit in ms, wie lange Karten sichtbar bleiben
  const player1 = "Antje"; // Hier den Namen des ersten Spielers eintragen
  const player2 = "Wolfgang";
  
  let gridRows, gridCols;
  function calcGrid() {
    const width = window.innerWidth;
    const height = window.innerHeight;

    // Bestimme Anzahl Spalten basierend auf Breite
    let cols;
    if (width < 480) cols = 4;
    else if (width < 768) cols = 5;
    else cols = 6;

    // Bestimme Anzahl Reihen basierend auf H√∂he
    let rows;
    if (height < 500) rows = 4;
    else if (height < 800) rows = 6;
    else rows = 8;

console.log("cols:", cols);
console.log("rows:", rows);

    gridCols = cols;
    gridRows = rows;
  }
  calcGrid();

  function resizeCards() {
    const board = document.getElementById('gameBoard');
    const gap = 15;
    const minCardSize = 70;

    const availableWidth = window.innerWidth - 20;
    const availableHeight = window.innerHeight - board.getBoundingClientRect().top - 40;

    const cardWidth = (availableWidth - (gridCols - 1) * gap) / gridCols;
    const cardHeight = (availableHeight - (gridRows - 1) * gap) / gridRows;
    const cardSize = Math.max(minCardSize, Math.min(cardWidth, cardHeight));

    console.log("cardWidth:", cardWidth);
    console.log("cardHeight:", cardHeight);
    console.log("card size:", cardSize);
    gameBoard.style.gridTemplateColumns = `repeat(${gridCols}, ${cardSize}px)`;
    gameBoard.style.gridTemplateRows = `repeat(${gridRows}, ${cardSize}px)`;

  }
  window.addEventListener('resize', resizeCards);

  const totalPairs = () => 2; //(gridRows * gridCols) / 2;

  // === Getr√§nke-Daten ===
const drinksData = [
  {
    player1: [
      { img: 'images/antje-kaffee.png', description: 'Annas Lieblingskaffee' },
      { img: 'images/antje-tee.png', description: 'Annas Lieblingstee' }
    ],
    player2: [
      { img: 'images/wolfgang-bier.png', description: 'Wolfgangs Lieblingsbier' },
      { img: 'images/wolfgang-wein.png', description: 'Wolfgangs Lieblingswein' }
    ]
  },
  {
    player1: [
      { img: 'images/antje-smoothie.png', description: 'Annas Smoothie' }
    ],
    player2: [
      { img: 'images/bier.png', description: 'Bier' },
      { img: 'images/wolfgang-sprite.png', description: 'Wolfgangs Sprite' }
    ]
  }
];

  let currentPlayer;
  let score1 = 0, score2 = 0;
  let flippedCards = [];
  let matchedCount = 0;

  function initGame() {
    score1 = 0; score2 = 0; matchedCount = 0;
    document.getElementById('score1').textContent = score1;
    document.getElementById('score2').textContent = score2;

    document.getElementById('player1').innerHTML = `üë© ${player1}: <span id="score1">0</span>`;
    document.getElementById('player2').innerHTML = `üë® ${player2}: <span id="score2">0</span>`;

    // Startspieler zuf√§llig bestimmen
    currentPlayer = Math.random() < 0.5 ? 1 : 2;
    updateActivePlayer();

    const selectedDrinks = shuffleArray(drinksData).slice(0, totalPairs());
    console.log("selectedDrinks:", selectedDrinks);
    const cardSet = [];

    selectedDrinks.forEach((drinkPair, index) => {
      const player1Drink = drinkPair.player1[Math.floor(Math.random() * drinkPair.player1.length)];
      const player2Drink = drinkPair.player2[Math.floor(Math.random() * drinkPair.player2.length)];
      const pairKey = `pair_${index}`;

      cardSet.push({ 
        type: 'player1',
        content: player1Drink.img, 
        description: player1Drink.description,
        matchKey: pairKey  
      });
      cardSet.push({ 
        type: 'player2', 
        content: player2Drink.img, 
        description: player2Drink.description,
        matchKey: pairKey 
      });
    });

    const shuffledCards = shuffleArray(cardSet);
    const gameBoard = document.getElementById('gameBoard');
    
    gameBoard.innerHTML = '';
    shuffledCards.forEach((card, index) => {
      const cardEl = document.createElement('div');
      cardEl.classList.add('card');
      cardEl.dataset.type = card.type;
      cardEl.dataset.matchKey = card.matchKey;
      cardEl.dataset.index = index;
      cardEl.title = card.description;

      const cardInner = document.createElement('div');
      cardInner.classList.add('card-inner');

      const cardFront = document.createElement('div');
      cardFront.classList.add('card-front');
      const cardFrontImg = document.createElement('img');
      cardFrontImg.src = 'images/background.png';
      cardFrontImg.alt = '?';
      cardFront.appendChild(cardFrontImg);

      const cardBack = document.createElement('div');
      cardBack.classList.add('card-back');
      const cardBackImg = document.createElement('img');
      cardBackImg.src = card.content;
      cardBackImg.alt = card.description;
      cardBack.appendChild(cardBackImg);

      cardInner.appendChild(cardFront);
      cardInner.appendChild(cardBack);
      cardEl.appendChild(cardInner);

      cardEl.addEventListener('click', () => flipCard(cardEl));
      gameBoard.appendChild(cardEl);
    });
    resizeCards();
  }

  function flipCard(cardEl) {
    if (cardEl.classList.contains('flipped') || cardEl.classList.contains('matched') || flippedCards.length === 2) {
      return;
    }
    cardEl.classList.add('flipped');
    flippedCards.push(cardEl);

    if (flippedCards.length === 2) {
      checkMatch();
    }
  }

  function checkMatch() {
    const [first, second] = flippedCards;
    if (first.dataset.matchKey === second.dataset.matchKey && first.dataset.type !== second.dataset.type) {
      setTimeout(() => {
        first.classList.add('matched');
        second.classList.add('matched');
        matchedCount++;
        if (currentPlayer === 1) {
            score1++;
            document.getElementById('score1').textContent = score1;
        } else {
            score2++;
            document.getElementById('score2').textContent = score2;
        }
        flippedCards = [];
        if (matchedCount === totalPairs()) {
            setTimeout(endGame, 500);
        }
      }, 700); // 0.7s pulse effekt
    }
    else {
        setTimeout(() => {
            first.classList.remove('flipped');
            second.classList.remove('flipped');
            flippedCards = [];
            currentPlayer = currentPlayer === 1 ? 2 : 1;
            updateActivePlayer();
        }, flipDelay);
    }
  }

  function updateActivePlayer() {
    document.getElementById("player1").classList.toggle("active", currentPlayer === 1);
    document.getElementById("player2").classList.toggle("active", currentPlayer === 2);
  }

  function endGame() {
    let winner = '';
    if (score1 > score2) winner = `${player1} gewinnt!`;
    else if (score2 > score1) winner = `${player2} gewinnt!`;
    else winner = 'Unentschieden!';
    alert(`Spiel beendet!\n${winner}`);
    initGame();
  }

  function shuffleArray(array) {
    return array.sort(() => Math.random() - 0.5);
  }

  initGame();
</script>
</body>
</html>